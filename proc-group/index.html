<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Process group - pipen</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="//use.fontawesome.com/releases/v5.8.1/css/all.css" rel="stylesheet" />
        <link href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css" rel="stylesheet" />
        <link href="../css/mkapi-common.css" rel="stylesheet" />
        <link href="../assets/style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Process group";
        var mkdocs_page_input_path = "proc-group.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.configure({ ignoreUnescapedHTML: true }); hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../rtd-logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="nav-scrollable-wrapper">
      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Introduction</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/beginner/">Beginner Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../defining-proc/">Defining a process</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../running/">Defining and running a pipeline</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">How-to Guides</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../templating/">Templating</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../channels/">Channels</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../input-output/">Input and output</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../script/">Script</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../caching/">Caching</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cloud/">Cloud support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../error/">Error handling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../configurations/">Configurations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plugin/">Plugins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scheduler/">Scheduler</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Process group</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cli/">Command line interface</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">pipen</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen/">pipen</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.pluginmgr/">pipen.pluginmgr</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.utils/">pipen.utils</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.proc/">pipen.proc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.version/">pipen.version</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.job/">pipen.job</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.scheduler/">pipen.scheduler</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.exceptions/">pipen.exceptions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.pipen/">pipen.pipen</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.channel/">pipen.channel</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.progressbar/">pipen.progressbar</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.template/">pipen.template</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.procgroup/">pipen.procgroup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.defaults/">pipen.defaults</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">pipen.cli</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.cli/">pipen.cli</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.cli.profile/">pipen.cli.profile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.cli.version/">pipen.cli.version</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.cli.help/">pipen.cli.help</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/pipen.cli.plugins/">pipen.cli.plugins</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CHANGELOG/">Change Log</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../glossary/">Glossary</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/">Architecture</a>
                  </li>
              </ul>
      </div>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">pipen</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">How-to Guides</li>
      <li class="breadcrumb-item active">Process group</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/pwwang/pipen/blob/master/docs/proc-group.md">Edit on pwwang/pipen</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p>A process group is a collection of processes that are related to each other. It is a convenient way to manage a set of processes.</p>
<p>With <code>pipen</code>, not only a process can be reused, but also a group of processes can be reused. We just need to define the relationship between the processes in the group, and then we can reuse the group in other pipelines, or even run it directly as a pipeline.</p>
<h3 id="define-a-process-group">Define a process group<a class="headerlink" href="#define-a-process-group" title="Permanent link">&para;</a></h3>
<p>To define a process group, we need to define a class that inherits from <code>pipen.procgroup.ProcGroup</code>. The class name will be the name of the group, unless we specify a <code>name</code> attribute.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pipen.procgroup</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcGroup</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyGroup</span><span class="p">(</span><span class="n">ProcGroup</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
<p>Note that the subclasses of <code>ProcGroup</code> are singleton classes. If you need to define multiple groups, you can define a base class and then inherit from it.</p>
<h3 id="add-processes-to-a-group">Add processes to a group<a class="headerlink" href="#add-processes-to-a-group" title="Permanent link">&para;</a></h3>
<p>There are two ways to add processes to a group, using <code>pg.add_proc</code> or <code>ProcGroup.add_proc</code>, where <code>pg</code> is a process group instance. The first method is used after the group is instantiated and it decorates a process class directly. The second method is used before the group is instantiated and it decorates a property of <code>ProcGroup</code> that returns a process.</p>
<ol>
<li>
<p>Using the <code>pg.add_proc()</code> decorator.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pipen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">ProcGroup</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyGroup</span><span class="p">(</span><span class="n">ProcGroup</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">pg</span> <span class="o">=</span> <span class="n">MyGroup</span><span class="p">()</span>

<span class="nd">@pg</span><span class="o">.</span><span class="n">add_proc</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyProc</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
</li>
<li>
<p>Using the <code>ProcGroup.add_proc()</code> decorator to decorate a property of the group class.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pipen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">ProcGroup</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyGroup</span><span class="p">(</span><span class="n">ProcGroup</span><span class="p">):</span>

    <span class="nd">@ProcGroup</span><span class="o">.</span><span class="n">add_proc</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">my_proc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span><span class="w"> </span><span class="nc">MyProc</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
            <span class="o">...</span>
        <span class="k">return</span> <span class="n">MyProc</span>
</code></pre></div>
</li>
</ol>
<p>This method adds a process at runtime, so it is useful when we want to add processes to a group dynamically.</p>
<h3 id="access-processes-in-a-group">Access processes in a group<a class="headerlink" href="#access-processes-in-a-group" title="Permanent link">&para;</a></h3>
<p>We can access the processes in a group using the <code>pg.&lt;proc&gt;</code> attribute, where <code>pg</code> is a process group instance. Note that when we use the <code>ProcGroup.add_proc</code> method to add processes, the process name is the name of the property.</p>
<p>However, you can always use <code>pg.procs.&lt;proc_name&gt;</code> to access the process, where the <code>&lt;proc_name&gt;</code> is the real name of the process.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pipen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">ProcGroup</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyGroup</span><span class="p">(</span><span class="n">ProcGroup</span><span class="p">):</span>

    <span class="nd">@ProcGroup</span><span class="o">.</span><span class="n">add_proc</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">my_proc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span><span class="w"> </span><span class="nc">MyProc</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
            <span class="o">...</span>
        <span class="k">return</span> <span class="n">MyProc</span>

<span class="n">pg</span> <span class="o">=</span> <span class="n">MyGroup</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">pg</span><span class="o">.</span><span class="n">my_proc</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MyProc&#39;</span>
<span class="k">assert</span> <span class="n">pg</span><span class="o">.</span><span class="n">procs</span><span class="o">.</span><span class="n">MyProc</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MyProc&#39;</span>
</code></pre></div>
<p>We can use <code>pg.starts</code> to get the start processes of the group, which are the processes that have no required processes. So when you add processes to a group, remember to specify <code>.requires</code> for each process, unless they are start processes.</p>
<h3 id="run-a-process-group-as-a-pipeline">Run a process group as a pipeline<a class="headerlink" href="#run-a-process-group-as-a-pipeline" title="Permanent link">&para;</a></h3>
<p>To run a process group as a pipeline, we can convert it to a pipeline using the <code>as_pipen()</code> method. The method takes the same arguments as the <code>Pipen</code> constructor.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pipen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">ProcGroup</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyGroup</span><span class="p">(</span><span class="n">ProcGroup</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">pg</span> <span class="o">=</span> <span class="n">MyGroup</span><span class="p">()</span>

<span class="nd">@pg</span><span class="o">.</span><span class="n">add_proc</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyProc</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">pg</span><span class="o">.</span><span class="n">as_pipen</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<h3 id="integrate-a-process-group-into-a-pipeline">Integrate a process group into a pipeline<a class="headerlink" href="#integrate-a-process-group-into-a-pipeline" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pipen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">ProcGroup</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyGroup</span><span class="p">(</span><span class="n">ProcGroup</span><span class="p">):</span>

    <span class="nd">@ProcGroup</span><span class="o">.</span><span class="n">add_proc</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">my_proc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span><span class="w"> </span><span class="nc">MyProc</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
            <span class="o">...</span>
        <span class="k">return</span> <span class="n">MyProc</span>

    <span class="nd">@ProcGroup</span><span class="o">.</span><span class="n">add_proc</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">my_proc2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">class</span><span class="w"> </span><span class="nc">MyProc2</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
            <span class="n">requires</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_proc</span>
            <span class="o">...</span>

        <span class="k">return</span> <span class="n">MyProc2</span>

<span class="n">pg</span> <span class="o">=</span> <span class="n">MyGroup</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PrepareData</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PostGroup</span><span class="p">(</span><span class="n">Proc</span><span class="p">):</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">my_proc2</span>

<span class="n">pg</span><span class="o">.</span><span class="n">my_proc</span><span class="o">.</span><span class="n">requires</span> <span class="o">=</span> <span class="n">PrepareData</span>

<span class="n">pipen</span> <span class="o">=</span> <span class="n">Pipen</span><span class="p">()</span><span class="o">.</span><span class="n">set_starts</span><span class="p">(</span><span class="n">PrepareData</span><span class="p">)</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../scheduler/" class="btn btn-neutral float-left" title="Scheduler"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../cli/" class="btn btn-neutral float-right" title="Command line interface">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  <div class="footer-notes">
    <a href="https://github.com/pwwang/pipen" title="Open repository in GitHub">Github Repo</a>
    <div class="footer-sep"></div>Built with <a href="https://www.mkdocs.org/">MkDocs</a> using theme <a href="https://github.com/pwwang/mkdocs-rtd">mkdocs-rtd</a>.
  </div>
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../scheduler/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cli/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/version-select.js"></script>
      <script src="../js/mkapi.js"></script>
      <script src="../assets/script.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
